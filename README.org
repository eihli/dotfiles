* Dotfiles

Managed with [[https://www.gnu.org/software/stow/][GNU Stow]]. Each directory is a stow package that gets symlinked to ~$HOME~.

** Quick Start

#+begin_src sh
# Clone
git clone git@github.com:eihli/dotfiles.git ~/src/dotfiles
cd ~/src/dotfiles

# Install (Debian/Ubuntu)
./install.sh

# Or manually stow individual packages
stow -t ~ fish tmux zellij starship git bash claude agents
#+end_src

** Required Tools

*** Core (install first)

| Tool     | Purpose                    | Install                          |
|----------+----------------------------+----------------------------------|
| fish     | Primary shell              | ~apt install fish~ / ~brew install fish~ |
| starship | Cross-shell prompt         | ~curl -sS https://starship.rs/install.sh \vert sh~ |
| fzf      | Fuzzy finder (Ctrl-R, Ctrl-T) | ~apt install fzf~ / ~brew install fzf~ |
| fd       | Fast find (used by fzf)    | ~apt install fd-find~ / ~brew install fd~ |
| mise     | Version manager (replaces pyenv/nvm) | ~curl https://mise.run \vert sh~ |

*** Terminal Multiplexer (pick one)

- ~tmux~ - prefix: ~C-]~ (to avoid Emacs conflict)
- ~zellij~ - modal, session persistence

** Stow Packages

| Package  | Contents                              |
|----------+---------------------------------------|
| fish     | ~.config/fish/config.fish~            |
| bash     | ~.bashrc~ (fallback for non-fish systems) |
| tmux     | ~.tmux.conf~, ~.tmux/~                |
| zellij   | ~.config/zellij/config.kdl~           |
| starship | ~.config/starship.toml~               |
| git      | ~.gitconfig~                          |
| claude   | ~.claude/~ (agents, skills)           |
| agents   | ~.config/AGENTS.md~                   |

** Machine-Specific Notes

*** Gnome Keyring

Get a keyring for credential storage:

#+begin_src sh
# May need xdg autostart modifications
# https://wiki.archlinux.org/title/GNOME/Keyring#Start_SSH_and_Secrets_components_of_keyring_daemon

# PAM config for auto-unlock
# https://wiki.gnome.org/Projects/GnomeKeyring/Pam
# Update /etc/pam.d/login

# If secrets service not starting:
systemctl --user add-wants autostart.target gnome-keyring-secrets.service
#+end_src

*** StumpWM (Common Lisp window manager)

#+begin_src sh
# Create ~/common-lisp directory
# Requirements:
#   - Set SBCL_HOME when building (avoids sb-cltl2 error)
#   - cl-utilities, ppath, sly
#   - clx-truetype: clone https://github.com/LispLima/clx-truetype to ~/quicklisp/local-projects

# Add .desktop to /usr/share/xsessions/ for display manager
#+end_src

*** Keyboard (Norman layout + Capsâ†’Esc)

#+begin_src sh
setxkbmap -variant norman -option lv3:ralt_alt
xmodmap -e "keycode 66 = Escape Escape" -e "keycode 9 = Caps_Lock Caps_Lock"
#+end_src

*** HiDPI

For Java Swing: use Java 9+ and set ~GDK_SCALE=2~.

*** Nvidia Hybrid Graphics

Don't trust ~nvidia-xconfig~ output. See [[https://wiki.archlinux.org/title/PRIME][Arch Wiki PRIME]].

#+begin_example
Section "Files"
    ModulePath "/usr/lib/xorg/modules"
    ModulePath "/usr/lib/nvidia/xorg"
EndSection

Section "Device"
    Identifier "Intel UHD"
    BusID "PCI:00:02:0"
    Driver "modesetting"
EndSection

Section "Device"
    Identifier "GeForce RTX 2080"
    Driver "nvidia"
    VendorName "NVIDIA Corporation"
    BusID "PCI:01:00:0"
EndSection
#+end_example

*** Arch Linux Base Packages

#+begin_src sh
sudo pacman -Syu fish git emacs ripgrep tmux \
    base-devel xclip cmake git-lfs docker

# AUR
yay -Syu starship-bin
#+end_src

*** Useful Apps

- [[https://github.com/jceb/dex][dex]] - auto-start XDG .desktop entries
- Fira fonts (~fc-list~, ~xset -q~ to verify)
