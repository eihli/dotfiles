#!/bin/bash
# Watch for notifications from claude agent running as another user
# Reads from FIFO, sends desktop notifications

PIPE="/run/claude-notify/pipe"

# Create FIFO if missing (directory must exist with correct perms)
if [[ ! -p "$PIPE" ]]; then
    mkfifo "$PIPE" 2>/dev/null && chmod 660 "$PIPE" || true
fi

while true; do
    if read -r msg < "$PIPE"; then
        notify-send "Claude Code" "$msg"
    fi
done
